<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†è€…ãƒšãƒ¼ã‚¸ - FX TradeLog Pro</title>
    <style>
        /* app.htmlã¨åŒã˜CSSå¤‰æ•°ã‚’ä½¿ç”¨ */
        :root {
            --color-background: #020617;
            --color-surface: rgba(15, 23, 42, 0.5);
            --color-text: #f1f5f9;
            --color-text-secondary: #cbd5e1;
            --color-primary: #00A9A5;
            --color-border: rgba(30, 41, 59, 0.6);
            --font-family-base: ui-sans-serif, system-ui, sans-serif;
            --space-4: 1rem;
            --space-6: 1.5rem;
            --radius-lg: 1rem;
        }
        
        body {
            font-family: var(--font-family-base);
            background: var(--color-background);
            color: var(--color-text);
            padding: var(--space-6);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .admin-section {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            margin-bottom: var(--space-4);
        }
        
        .btn {
            background: var(--color-primary);
            color: #020617;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
        }
        
        .btn-secondary {
            background: rgba(203, 213, 225, 0.2);
            color: var(--color-text);
        }
        
        input, select {
            background: var(--color-background);
            border: 1px solid var(--color-border);
            color: var(--color-text);
            padding: 8px 12px;
            border-radius: 6px;
            margin-right: 8px;
        }
        
        .log {
            background: #0f172a;
            padding: 16px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin-top: 16px;
        }
    </style>
</head>
<body>
    <!-- ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰èªè¨¼ç”»é¢ -->
    <div id="passcodeScreen" style="
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--color-background);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
    ">
        <div style="
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: 40px;
            max-width: 400px;
            width: 90%;
            text-align: center;
        ">
            <h2 style="margin-bottom: 24px;">ğŸ” ç®¡ç†è€…èªè¨¼</h2>
            <p style="color: var(--color-text-secondary); margin-bottom: 24px;">
                ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„
            </p>
            <input 
                type="password" 
                id="passcodeInput" 
                placeholder="ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›"
                style="
                    width: 100%;
                    padding: 12px 16px;
                    font-size: 16px;
                    border-radius: 8px;
                    border: 1px solid var(--color-border);
                    background: var(--color-background);
                    color: var(--color-text);
                    margin-bottom: 16px;
                "
            >
            <button 
                onclick="checkPasscode()" 
                class="btn" 
                style="width: 100%;"
            >
                ãƒ­ã‚°ã‚¤ãƒ³
            </button>
            <p id="passcodeError" style="
                color: #ef4444;
                margin-top: 16px;
                display: none;
            ">
                ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã¾ã™
            </p>
        </div>
    </div>

    <div id="adminContent" style="display: none;">
        <h1>ğŸ› ï¸ ç®¡ç†è€…ãƒšãƒ¼ã‚¸</h1>
        <p style="color: var(--color-text-secondary);">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŠ•å…¥ã¨ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ç®¡ç†</p>
        
        <!-- ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŠ•å…¥ -->
    <div class="admin-section">
        <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŠ•å…¥</h2>
        <p>ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆç”¨ã®ãƒªã‚¢ãƒ«ãªãƒˆãƒ¬ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>
        
        <label>
            ãƒ‡ãƒ¼ã‚¿æ•°: 
            <input type="number" id="testDataCount" value="20" min="5" max="100">
        </label>
        
        <label>
            æœŸé–“ï¼ˆæ—¥æ•°ï¼‰: 
            <input type="number" id="testDataDays" value="30" min="7" max="90">
        </label>
        
        <br><br>
        <button class="btn" onclick="generateTestData()">ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ</button>
        <button class="btn-danger btn" onclick="clearAllData()">å…¨ãƒ‡ãƒ¼ã‚¿å‰Šé™¤</button>
        
        <div class="log" id="dataLog"></div>
    </div>
    
    <!-- ãƒ—ãƒ©ãƒ³ç®¡ç† -->
    <div class="admin-section">
        <h2>ğŸ‘¤ ãƒ—ãƒ©ãƒ³ç®¡ç†</h2>
        <p>ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³: <strong id="currentPlan">-</strong></p>
        
        <button class="btn" onclick="setPlan('early_pro')">Early Pro</button>
        <button class="btn" onclick="setPlan('free')">Free</button>
        <button class="btn" onclick="setPlan('pro')">Pro</button>
        <button class="btn-secondary btn" onclick="resetConsultation()">ç›¸è«‡äºˆç´„ãƒªã‚»ãƒƒãƒˆ</button>
    </div>
    
    <!-- ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­å®š -->
    <div class="admin-section">
        <h2>ğŸ‰ ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­å®š</h2>
        
        <label>
            å…ˆç€50äººã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³: 
            <select id="campaignActive" onchange="updateCampaign()">
                <option value="true">æœ‰åŠ¹</option>
                <option value="false">ç„¡åŠ¹</option>
            </select>
        </label>
        
        <label>
            ç¾åœ¨ã®ç™»éŒ²è€…æ•°: 
            <input type="number" id="campaignSignups" value="0" min="0" max="50">
        </label>
        
        <button class="btn" onclick="updateCampaign()">è¨­å®šã‚’ä¿å­˜</button>
    </div>
    
    <!-- ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹ -->
    <div class="admin-section">
        <h2>ğŸ”™ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h2>
        <button class="btn" onclick="window.location.href='app.html'">ã‚¢ãƒ—ãƒªã«æˆ»ã‚‹</button>
        <button class="btn-secondary btn" onclick="window.open('app.html', '_blank')">æ–°è¦ã‚¿ãƒ–ã§ã‚¢ãƒ—ãƒªã‚’é–‹ã</button>
        <button class="btn-danger btn" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
    </div>
    </div>
    
    <script>
        // ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰è¨­å®šï¼ˆå¤‰æ›´å¯èƒ½ï¼‰
        const ADMIN_PASSCODE = 'tradelog2025';  // â† ãŠå¥½ããªãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ã«å¤‰æ›´ã—ã¦ãã ã•ã„
        
        // ãƒ‘ã‚¹ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯
        function checkPasscode() {
            const input = document.getElementById('passcodeInput');
            const error = document.getElementById('passcodeError');
            
            if (input.value === ADMIN_PASSCODE) {
                // èªè¨¼æˆåŠŸ
                localStorage.setItem('adminAuthenticated', 'true');
                document.getElementById('passcodeScreen').style.display = 'none';
                document.getElementById('adminContent').style.display = 'block';
                logMessage('âœ… ç®¡ç†è€…èªè¨¼æˆåŠŸ');
            } else {
                // èªè¨¼å¤±æ•—
                error.style.display = 'block';
                input.value = '';
                input.focus();
            }
        }
        
        // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½
        function logout() {
            localStorage.removeItem('adminAuthenticated');
            location.reload();
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            const input = document.getElementById('passcodeInput');
            input?.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    checkPasscode();
                }
            });
            
            // æ—¢ã«èªè¨¼æ¸ˆã¿ã‹ãƒã‚§ãƒƒã‚¯ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶™ç¶šï¼‰
            const isAuthenticated = localStorage.getItem('adminAuthenticated') === 'true';
            if (isAuthenticated) {
                document.getElementById('passcodeScreen').style.display = 'none';
                document.getElementById('adminContent').style.display = 'block';
                updatePlanDisplay();
                loadCampaignSettings();
            } else {
                input?.focus();
            }
        });
        
        // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        function generateTestData() {
            const count = parseInt(document.getElementById('testDataCount').value);
            const days = parseInt(document.getElementById('testDataDays').value);
            
            const pairs = ['USD/JPY', 'EUR/JPY', 'GBP/JPY', 'AUD/JPY', 'EUR/USD'];
            const directions = ['buy', 'sell'];
            
            const trades = [];
            const now = new Date();
            
            for (let i = 0; i < count; i++) {
                const daysAgo = Math.floor(Math.random() * days);
                const date = new Date(now);
                date.setDate(date.getDate() - daysAgo);
                
                const pair = pairs[Math.floor(Math.random() * pairs.length)];
                const direction = directions[Math.floor(Math.random() * 2)];
                const isWin = Math.random() > 0.4; // 60%å‹ç‡
                
                const pnl = isWin 
                    ? Math.floor(Math.random() * 5000) + 1000
                    : -Math.floor(Math.random() * 3000) - 500;
                
                const entryPrice = direction === 'buy' ? 150.00 : 150.50;
                const exitPrice = isWin 
                    ? (direction === 'buy' ? entryPrice + 0.30 : entryPrice - 0.30)
                    : (direction === 'buy' ? entryPrice - 0.20 : entryPrice + 0.20);
                
                const trade = {
                    id: Date.now() + '-' + i,
                    date: date.toISOString(),
                    pair: pair,
                    direction: direction,
                    entryPrice: parseFloat(entryPrice.toFixed(2)),
                    exitPrice: parseFloat(exitPrice.toFixed(2)),
                    lotSize: parseFloat((Math.random() * 2 + 0.1).toFixed(2)),
                    pnl: pnl,
                    notes: isWin ? 'ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ•ã‚©ãƒ­ãƒ¼æˆåŠŸ' : 'æåˆ‡ã‚Šå®Ÿè¡Œ',
                    timestamp: date.getTime(),
                    pipSize: pair.includes('JPY') ? 0.01 : 0.0001
                };
                
                // æç›Šè¨ˆç®—
                if (pair.includes('JPY')) {
                    if (direction === 'buy') {
                        trade.pips = parseFloat(((exitPrice - entryPrice) * 100).toFixed(2));
                    } else {
                        trade.pips = parseFloat(((entryPrice - exitPrice) * 100).toFixed(2));
                    }
                } else {
                    trade.pips = parseFloat((Math.abs(exitPrice - entryPrice) * 10000).toFixed(2));
                }
                
                trades.push(trade);
            }
            
            // localStorageã«ä¿å­˜ï¼ˆapp.htmlã¨åŒã˜ã‚­ãƒ¼ã‚’ä½¿ç”¨ï¼‰
            const FULL_TRADES_KEY = 'fx_trades_full';
            const existingTrades = JSON.parse(localStorage.getItem(FULL_TRADES_KEY) || '[]');
            const allTrades = [...existingTrades, ...trades];
            localStorage.setItem(FULL_TRADES_KEY, JSON.stringify(allTrades));
            
            // AIç”¨ç°¡æ˜“ãƒ‡ãƒ¼ã‚¿ã«ã‚‚åŒæœŸ
            const lsTrades = trades.map(t => ({
                date: t.date.slice(0, 10),
                pair: t.pair,
                side: t.direction === 'buy' ? 'è²·' : 'å£²',
                lot: t.lotSize,
                entry: t.entryPrice,
                exit: t.exitPrice,
                pnl: t.pnl,
                rule: 'â€”',
                memo: t.notes
            }));
            const existingSimpleTrades = JSON.parse(localStorage.getItem('fx_trades') || '[]');
            localStorage.setItem('fx_trades', JSON.stringify([...existingSimpleTrades, ...lsTrades]));
            
            logMessage(`âœ… ${count}ä»¶ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã—ãŸï¼ˆéå»${days}æ—¥åˆ†ï¼‰`);
            logMessage(`å‹ç‡: ${Math.floor((trades.filter(t => t.pnl > 0).length / trades.length) * 100)}%`);
        }
        
        // å…¨ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
        function clearAllData() {
            if (!confirm('æœ¬å½“ã«å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) return;
            
            localStorage.removeItem('fx_trades_full');
            localStorage.removeItem('fx_trades');
            logMessage('ğŸ—‘ï¸ å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¾ã—ãŸ');
        }
        
        // ãƒ—ãƒ©ãƒ³è¨­å®š
        function setPlan(plan) {
            localStorage.setItem('userPlan', plan);
            updatePlanDisplay();
            logMessage(`âœ… ãƒ—ãƒ©ãƒ³ã‚’ ${plan} ã«å¤‰æ›´ã—ã¾ã—ãŸ`);
        }
        
        function updatePlanDisplay() {
            const plan = localStorage.getItem('userPlan') || 'free';
            document.getElementById('currentPlan').textContent = plan;
        }
        
        // ç›¸è«‡äºˆç´„ãƒªã‚»ãƒƒãƒˆ
        function resetConsultation() {
            localStorage.removeItem('consultationBooked');
            localStorage.removeItem('consultationData');
            localStorage.removeItem('consultationDate');
            logMessage('âœ… ç›¸è«‡äºˆç´„ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
        }
        
        // ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­å®šèª­ã¿è¾¼ã¿
        function loadCampaignSettings() {
            const active = localStorage.getItem('campaignActive') !== 'false';
            const signups = localStorage.getItem('campaignSignups') || '0';
            
            document.getElementById('campaignActive').value = active.toString();
            document.getElementById('campaignSignups').value = signups;
        }
        
        // ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­å®šæ›´æ–°
        function updateCampaign() {
            const active = document.getElementById('campaignActive').value === 'true';
            const signups = document.getElementById('campaignSignups').value;
            
            localStorage.setItem('campaignActive', active.toString());
            localStorage.setItem('campaignSignups', signups);
            
            logMessage(`âœ… ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­å®šã‚’æ›´æ–°ã—ã¾ã—ãŸï¼ˆæœ‰åŠ¹: ${active}, ç™»éŒ²è€…: ${signups}ï¼‰`);
        }
        
        // ãƒ­ã‚°å‡ºåŠ›
        function logMessage(msg) {
            const log = document.getElementById('dataLog');
            const time = new Date().toLocaleTimeString('ja-JP');
            log.innerHTML += `[${time}] ${msg}<br>`;
            log.scrollTop = log.scrollHeight;
        }
    </script>
</body>
</html>

